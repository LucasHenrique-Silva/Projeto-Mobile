<ion-header>
  <ion-toolbar>
    <ion-title>Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <!-- Campo para o nome com validação automática -->
    <form [formGroup]="profileForm" (ngSubmit)="saveProfile()">
    <ion-item
      [class.invalid]="profileForm.get('name')?.invalid && profileForm.get('name')?.touched"
    >
      <ion-label position="floating">Name</ion-label>
      <ion-input formControlName="name"></ion-input>
      <ion-note
        slot="error"
        *ngIf="profileForm.get('name')?.errors?.['required'] && profileForm.get('name')?.touched"
      >
        Name is required.
      </ion-note>
      <ion-note
        slot="error"
        *ngIf="profileForm.get('name')?.errors?.['pattern'] && profileForm.get('name')?.touched"
      >
        Name must be at least 3 characters long and cannot contain numbers or special characters.
      </ion-note>
    </ion-item>

    <!-- Campo para o email com validação automática -->
    <ion-item
      [class.invalid]="profileForm.get('email')?.invalid && profileForm.get('email')?.touched"
    >
      <ion-label position="floating">Email</ion-label>
      <ion-input formControlName="email" type="email"></ion-input>
      <ion-note
        slot="error"
        *ngIf="profileForm.get('email')?.errors?.['required'] && profileForm.get('email')?.touched"
      >
        Email is required.
      </ion-note>
      <ion-note
        slot="error"
        *ngIf="profileForm.get('email')?.errors?.['email'] && profileForm.get('email')?.touched"
      >
        Please enter a valid email address.
      </ion-note>
    </ion-item>

    <!-- Campo para a data de nascimento -->
    <ion-item (click)="openDatePicker()">
      <ion-label position="stacked">Date of birth</ion-label>
      <ion-input
        [value]="dateOfBirth ? (dateOfBirth | date: 'dd/MM/yyyy') : ''"
        placeholder=" "
        readonly
      >
      </ion-input>
      <ion-note
        slot="error"
        *ngIf="profileForm.get('dateOfBirth')?.errors?.['required'] && profileForm.get('dateOfBirth')?.touched"
      >
        Date of birth is required.
      </ion-note>
    </ion-item>

    <!-- Modal para exibir o calendário -->
    <ion-modal [isOpen]="isModalOpen" (didDismiss)="closeModal()">
      <ng-template>
        <ion-header>
          <ion-toolbar>
            <ion-title>Select Date of Birth</ion-title>
            <ion-buttons slot="end">
              <ion-button (click)="closeModal()">Close</ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>

        <ion-content>
          <ion-datetime
            formControlName="dateOfBirth"
            displayFormat="DD/MM/YYYY"
            pickerFormat="DD/MM/YYYY"
            [min]="minDate"
            [max]="maxDate"
          >
          </ion-datetime>
          <ion-button expand="full" (click)="saveDate()">Save Date</ion-button>
        </ion-content>
      </ng-template>
    </ion-modal>

    <!-- Botão para salvar o perfil -->
    <ion-footer>
      <ion-button expand="full" type="submit" [disabled]="profileForm.invalid">
        Save Profile
      </ion-button>
    </ion-footer>
  </form>
</ion-content>
